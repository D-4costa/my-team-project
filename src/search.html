<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sleep Outside | Search</title>
    <link rel="stylesheet" href="./css/style.css" />
  </head>

  <body>
    <header class="divider">
      <div class="logo">
        <a href="./index.html">
          Sleep <span class="highlight">Outside</span>
        </a>
      </div>
      <nav>
        <a href="./index.html">Home</a>
        <a href="./search.html">Search</a>
      </nav>
    </header>

    <main class="products">
      <h2 class="divider">Search Products</h2>

      <p>
        <input
          type="text"
          id="searchInput"
          placeholder="Search by name or brand"
          aria-label="Search products"
        />
      </p>

      <ul class="product-list"></ul>
    </main>

    <footer>
      <p>&copy; Sleep Outside</p>
    </footer>

    <script type="module">
      import ProductData from "./ProductData.mjs";
      import { renderListWithTemplate } from "./utils.mjs";

      const dataSource = new ProductData("tents");
      const listElement = document.querySelector(".product-list");
      const searchInput = document.querySelector("#searchInput");

      function productTemplate(product) {
        return `
          <li class="product-card">
            <img src="${product.Image}" alt="${product.Name}" />
            <p class="card__brand">${product.Brand}</p>
            <h3 class="card__name">${product.Name}</h3>
            <p class="highlight">$${product.Price}</p>
          </li>
        `;
      }

      let allProducts = [];

      async function loadProducts() {
        allProducts = await dataSource.getData();
        renderProducts(allProducts);
      }

      function renderProducts(products) {
        renderListWithTemplate(
          productTemplate,
          listElement,
          products,
          "afterbegin",
          true
        );
      }

      function filterProducts(searchTerm) {
        const filtered = allProducts.filter((product) => {
          return (
            product.Name.toLowerCase().includes(searchTerm) ||
            product.Brand.toLowerCase().includes(searchTerm)
          );
        });

        renderProducts(filtered);
      }

      searchInput.addEventListener("input", (event) => {
        filterProducts(event.target.value.toLowerCase());
      });

      loadProducts();
    </script>
  </body>
</html>


